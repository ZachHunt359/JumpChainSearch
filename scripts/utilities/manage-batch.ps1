param([string]$Action = "monitor"); function Write-Status { param([string]$Message, [string]$Color = "White"); Write-Host "[$(Get-Date -Format 'HH:mm:ss')] $Message" -ForegroundColor $Color }; function Get-ServerStatus { try { $result = Invoke-RestMethod -Uri "http://localhost:5248/simple-test" -Method GET -TimeoutSec 5; return $true } catch { return $false } }; function Get-BatchProgress { try { $result = Invoke-RestMethod -Uri "http://localhost:5248/debug-extraction-status" -Method GET; return $result } catch { return $null } }; function Show-Status { Write-Status "Checking current status..." "Cyan"; if (-not (Get-ServerStatus)) { Write-Status "Server is not running" "Red"; return }; Write-Status "Server is running" "Green"; $status = Get-BatchProgress; if ($status) { Write-Status "Database Status:" "White"; Write-Status "  Total: $($status.total), Extracted: $($status.actuallyExtracted), Remaining: $($status.unprocessed), Failed: $($status.emptyText)" "White"; $progress = if ($status.total -gt 0) { [math]::Round(($status.actuallyExtracted / $status.total) * 100, 1) } else { 0 }; Write-Status "  Progress: $progress%" "Cyan" } }; switch ($Action.ToLower()) { "check-status" { Show-Status } default { Show-Status } }
